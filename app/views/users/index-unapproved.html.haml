%head
  %script{:type => "text/javascript", :src=> "https://code.jquery.com/jquery-3.4.1.js", :integrity=> "sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=", :crossorigin=> "anonymous"}
  %script{:type => "text/javascript", :src=> "https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js", :integrity=> "sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM", :crossorigin=> "anonymous"}
  %link{:rel => :stylesheet, :type => "text/css", :href => "https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css", :crossorigin=>"anonymous"}
  %link{:rel => :stylesheet, :type => "text/css", :href => "https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css", :crossorigin=>"anonymous"}
  = stylesheet_link_tag "application"
    
%div.d-flex.flex-row 
  %div.col-3
    %h2 
      = link_to 'Approved Users', users_index_path
  %div.col-3
    %h2 Unapproved Users
  %div.col-6.mb-1
    = link_to 'Logout', destroy_user_session_path, :method => 'DELETE', :class => "btn btn-danger float-right ml-2"
    = link_to 'Animal Dashboard', animals_path, :class => "btn btn-primary float-right"

= form_with url: users_update_path, :method => :get do |f|   
  %table#userTable.table.table-striped.table-bordered.table-lg
    %thead
      %tr
        %th Approved
        %th First Name
        %th Last Name
        %th Email
        %th View
        %th Edit
        %th Add
        %th Delete
        %th Created At
        
    %tbody
      - @users.each do |user|
        %tr
          // %td= user.admin
          %td= f.check_box "users[#{user.id}][approved]", {checked: user.approved, :class => "form-control"}, 'true', 'false'
          %td= text_field "users[#{user.id}]", 'first_name', value: user.first_name, :class => "form-control"
          %td= text_field "users[#{user.id}]", 'last_name', value: user.last_name, :class => "form-control"
          %td= text_field "users[#{user.id}]", 'email', value: user.email, :class => "form-control"
          %td= f.check_box "users[#{user.id}][can_view]", {checked: user.can_view, :class => "form-control"}, 'true', 'false'
          %td= f.check_box "users[#{user.id}][can_edit]", {checked: user.can_edit, :class => "form-control"}, 'true', 'false'
          %td= f.check_box "users[#{user.id}][can_add]", {checked: user.can_add, :class => "form-control"}, 'true', 'false'
          %td= f.check_box "users[#{user.id}][can_delete]", {checked: user.can_delete, :class => "form-control"}, 'true', 'false'
          %td= local_time(user.created_at)
  = submit_tag 'Update', :class => "btn btn-primary"
        
%script{:type => "text/javascript", :src => "https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"}
%script{:type => "text/javascript", :src => "https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"}
:javascript
  $(document).ready(function () {
    var simple_checkbox = function (data, type, full, meta) {
      var is_checked = (data === 'true') ? "checked" : "";
      // console.log("DATA: " + is_checked);
      return '<label class="checkbox-label">' +
              '<input type="checkbox" class="checkbox" ' + is_checked + ' />' +
              '<span class="checkbox-custom rectangular"></span>' +
             '</label>'
    }
    
    var dataTable = $('#userTable').dataTable({
      "pageLength": 50,
      "search": {
        "caseInsensitive": true
      },
      "stateSave" : true,
      "columns": [
          { "data": "Approved", "className": "text-center"},
          { "data": "First Name"},
          { "data": "Last Name"},
          { "data": "Email"},
          { "data": "View", "className": "text-center"},
          { "data": "Edit", "className": "text-center"},
          { "data": "Add", "className": "text-center"},
          { "data": "Delete", "className": "text-center"},
          { "data": "Created At"}
      ],
    });
    $('.dataTables_length').addClass('bs-select');
  });


// references
// Styling - https://codepen.io/cristinaconacel/pen/zmgmxE
// Checkboxes - http://live.datatables.net/kovegexo/1/edit
//            - https://stackoverflow.com/questions/27276108/best-way-to-render-boolean-data-columns-in-jquery-datatables-net